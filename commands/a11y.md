---
description: Accessibility audit and WCAG compliance checking with auto-fix capabilities
argument-hint: "[--standard=WCAG2.1|Section508] [--level=A|AA|AAA] [--fix] [--report]"
model: sonnet
---

# Autopilot: A11Y Mode
# Project Autopilot - Accessibility audit
# Copyright (c) 2026 Jeremy McSpadden <jeremy@fluxlabs.net>

Comprehensive accessibility audit with WCAG compliance checking, issue prioritization, and auto-fix capabilities.

## Required Skills

**Read before auditing:**
1. `/autopilot/skills/accessibility/SKILL.md` - WCAG guidelines and patterns
2. `/autopilot/skills/token-optimization/SKILL.md` - Minimize token usage

## Required Agents

- `reviewer` - Code analysis
- `model-selector` - Choose optimal model

---

## Options

| Option | Description |
|--------|-------------|
| `--standard=std` | WCAG2.1, WCAG2.2, Section508 |
| `--level=lvl` | Conformance level: A, AA, AAA |
| `--fix` | Auto-fix compatible issues |
| `--report` | Generate detailed report |
| `--component=path` | Audit specific component |
| `--url=url` | Audit live URL |
| `--ci` | CI mode (exit code on failure) |

---

## Usage

### Basic Accessibility Audit

```bash
/autopilot:a11y
```

Output:
```markdown
## Accessibility Audit Report

**Standard:** WCAG 2.1
**Level:** AA
**Files Analyzed:** 45
**Components:** 23

### Summary

| Category | Issues | Auto-fixable |
|----------|--------|--------------|
| üî¥ Critical | 3 | 0 |
| üü† Serious | 8 | 3 |
| üü° Moderate | 12 | 8 |
| üü¢ Minor | 5 | 5 |

### Compliance Score
```
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 72% (Target: 100%)
```

---

### Critical Issues (Must Fix)

#### 1. Missing Alternative Text
**WCAG:** 1.1.1 (Level A)
**Files:** 5 components

```tsx
// ‚ùå src/components/ProductCard.tsx:23
<img src={product.image} />

// ‚úÖ Fix
<img
  src={product.image}
  alt={product.name}
/>
```

**Impact:** Screen reader users cannot understand image content.

#### 2. Insufficient Color Contrast
**WCAG:** 1.4.3 (Level AA)
**Files:** 3 components

```css
/* ‚ùå src/styles/buttons.css:15 */
.btn-secondary {
  color: #888;           /* 2.5:1 ratio */
  background: #fff;
}

/* ‚úÖ Fix - 4.5:1 ratio required */
.btn-secondary {
  color: #595959;        /* 4.5:1 ratio */
  background: #fff;
}
```

**Impact:** Users with low vision cannot read button text.

#### 3. Missing Form Labels
**WCAG:** 1.3.1 (Level A)
**Files:** 2 components

```tsx
// ‚ùå src/components/SearchBox.tsx:12
<input type="text" placeholder="Search..." />

// ‚úÖ Fix
<label htmlFor="search" className="sr-only">Search</label>
<input
  id="search"
  type="text"
  placeholder="Search..."
  aria-label="Search"
/>
```

**Impact:** Screen reader users don't know input purpose.

---

### Serious Issues

#### 4. Missing Skip Link
**WCAG:** 2.4.1 (Level A)
**File:** src/components/Layout.tsx

```tsx
// ‚úÖ Add at beginning of page
<a href="#main-content" className="skip-link">
  Skip to main content
</a>

// CSS
.skip-link {
  position: absolute;
  left: -9999px;
}
.skip-link:focus {
  left: 0;
  top: 0;
  z-index: 9999;
}
```

#### 5. Keyboard Navigation Issues
**WCAG:** 2.1.1 (Level A)
**Files:** Custom dropdown, modal components

```tsx
// ‚ùå Not keyboard accessible
<div onClick={handleClick}>
  Click me
</div>

// ‚úÖ Keyboard accessible
<button
  onClick={handleClick}
  onKeyDown={(e) => e.key === 'Enter' && handleClick()}
>
  Click me
</button>
```

---

### Moderate Issues

| Issue | WCAG | Count | Auto-fix |
|-------|------|-------|----------|
| Missing lang attribute | 3.1.1 | 1 | ‚úÖ |
| Focus not visible | 2.4.7 | 4 | ‚úÖ |
| Missing heading structure | 1.3.1 | 3 | ‚ùå |
| Touch target too small | 2.5.5 | 4 | ‚úÖ |

---

### Auto-Fix Summary

**16 issues can be auto-fixed:**
- 5 missing alt text (template available)
- 3 color contrast (calculated values)
- 5 missing ARIA labels
- 3 focus styles

Run with `--fix` to apply.
```

### With Auto-Fix

```bash
/autopilot:a11y --fix
```

Output:
```markdown
## Accessibility Auto-Fix Applied

### Changes Made

| File | Issue | Fix Applied |
|------|-------|-------------|
| src/components/ProductCard.tsx | Missing alt | Added alt attribute |
| src/components/Button.tsx | Low contrast | Updated color |
| src/components/Input.tsx | Missing label | Added aria-label |
| src/styles/global.css | Focus style | Added focus ring |

### Diff Summary

```diff
// src/components/ProductCard.tsx
- <img src={product.image} />
+ <img src={product.image} alt={product.name} />

// src/styles/buttons.css
- color: #888;
+ color: #595959;
```

### Remaining Manual Fixes: 7

These require human judgment:
1. Heading structure reorganization
2. Complex navigation patterns
3. Dynamic content announcements
```

### Specific Level Audit

```bash
/autopilot:a11y --standard=WCAG2.1 --level=AAA
```

---

## Behavior

```
FUNCTION auditAccessibility(options):

    # 1. Determine audit scope
    IF options.component:
        files = [options.component]
    ELIF options.url:
        content = fetchAndParse(options.url)
    ELSE:
        files = findUIComponents()

    # 2. Load WCAG rules
    rules = loadWCAGRules(options.standard, options.level)

    # 3. Run accessibility checks
    issues = []
    FOR each file IN files:
        fileIssues = runAccessibilityChecks(file, rules)
        issues.concat(fileIssues)

    # 4. Calculate contrast ratios
    contrastIssues = analyzeColorContrast(files)
    issues.concat(contrastIssues)

    # 5. Check keyboard navigation
    keyboardIssues = checkKeyboardNavigation(files)
    issues.concat(keyboardIssues)

    # 6. Prioritize and categorize
    categorized = categorizeIssues(issues)
    prioritized = prioritizeBySeverity(categorized)

    # 7. Auto-fix if requested
    IF options.fix:
        fixable = issues.filter(i => i.autoFixable)
        FOR each issue IN fixable:
            applyAccessibilityFix(issue)
        LOG "Applied {fixable.length} fixes"

    # 8. Generate report
    IF options.report:
        writeReport(prioritized, ".autopilot/a11y-report.md")

    # 9. Display results
    DISPLAY accessibilitySummary(prioritized)

    # 10. CI mode exit code
    IF options.ci AND categorized.critical.length > 0:
        EXIT 1
```

---

## WCAG Reference

### Level A (Minimum)

| Criterion | Description |
|-----------|-------------|
| 1.1.1 | Non-text content has alternatives |
| 1.3.1 | Info and relationships programmatic |
| 2.1.1 | Keyboard accessible |
| 2.4.1 | Bypass blocks (skip links) |
| 4.1.1 | Valid HTML parsing |
| 4.1.2 | Name, role, value for controls |

### Level AA (Standard)

| Criterion | Description |
|-----------|-------------|
| 1.4.3 | Contrast minimum (4.5:1 text) |
| 1.4.4 | Text resize to 200% |
| 2.4.6 | Headings and labels descriptive |
| 2.4.7 | Focus visible |
| 3.2.3 | Consistent navigation |
| 3.2.4 | Consistent identification |

### Level AAA (Enhanced)

| Criterion | Description |
|-----------|-------------|
| 1.4.6 | Contrast enhanced (7:1 text) |
| 1.4.8 | Visual presentation controls |
| 2.4.9 | Link purpose from link text alone |
| 3.1.3 | Unusual words defined |

---

## Quick Examples

```bash
# Basic audit (WCAG 2.1 AA)
/autopilot:a11y

# AAA compliance audit
/autopilot:a11y --level=AAA

# Section 508 compliance
/autopilot:a11y --standard=Section508

# Auto-fix issues
/autopilot:a11y --fix

# Audit specific component
/autopilot:a11y --component=src/components/Modal.tsx

# CI mode with report
/autopilot:a11y --ci --report

# Audit live URL
/autopilot:a11y --url=https://example.com
```

$ARGUMENTS
